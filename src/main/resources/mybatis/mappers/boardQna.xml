<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper.boardQna">
	<resultMap id="qnasResult" type="QnaVO">
		<result property="level" column="level" />
		<result property="qna_no" column="qna_no" />
		<result property="qnaparent_no" column="qnaparent_no" />
		<result property="qna_title" column="qna_title" />
		<result property="qna_content" column="qna_content" />
		<result property="qna_date" column="qna_date" />
	</resultMap>


	<!-- 상담글 리스트 불러오기 -->
	<select id="selectAllQnasList" resultMap="qnasResult">
    <![CDATA[
      SELECT level, qna_no, qnaparent_no, qna_title, qna_content, qna_date, member_id
      FROM board_qna
      START WITH  qnaparent_no=0
      CONNECT BY PRIOR qna_no=qnaparent_no 
      ORDER SIBLINGS BY qna_no DESC 
    ]]>
	</select>
	
	<!-- 새 상담글 내용 셀렉하기 -->
	<select id="selectNewQnaNO" resultType="int">
    <![CDATA[
      SELECT nvl(max(qna_no), 0) + 1
      FROM board_qna
    ]]>
	</select>
	
	<!-- 상담글 추가하기 -->
	<insert id="insertNewQna" parameterType="java.util.Map">
    <![CDATA[
      INSERT INTO board_qna(qna_no, qnaparent_no, member_id, qna_title, qna_content)
      VALUES(#{qna_no}, #{qnaparent_no}, #{member_id}, #{qna_title}, #{qna_content})
    ]]>
	</insert>
	
	<!--  -->
	<select id="selectQna" resultType="QnaVO" parameterType="int">
    <![CDATA[
      SELECT * from board_qna
      WHERE qna_no = #{qna_no}		
    ]]>
	</select>

</mapper>