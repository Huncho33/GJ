<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mapper.mypage">
	<resultMap id="qnasResult" type="QnaVO">
		<result property="level" column="lvl" />
		<result property="qna_no" column="qna_no" />
		<result property="member_id" column="member_id" />
		<result property="qnaparent_no" column="qnaparent_no" />
		<result property="qna_title" column="qna_title" />
		<result property="qna_content" column="qna_content" />
		<result property="qna_date" column="qna_date" />
		<result property="qna_pw" column="qna_pw" />
		<result property="qna_policy" column="qna_policy" />
		<result property="qna_reply" column="qna_reply" />
	</resultMap>


	<!-- 수정/업데이트 할 아이디 조회 -->
	<select id="selectMemberById" resultType="memberVO"
		parameterType="String">
		<![CDATA[
			SELECT * FROM member
			WHERE member_id=#{member_id}
		]]>
	</select>

	<!-- 회원 정보 수정 -->
	<update id="updateMember" parameterType="java.util.HashMap">
			UPDATE member
			<set>
				<if test=" member_pw!='' and member_pw!=null">
					member_pw=#{member_pw},
				</if>
				<if test=" member_phoneno!='' and member_phoneno!=null">
					member_phoneno=#{member_phoneno},
				</if>
				<if test=" member_email1!='' and member_email1!=null">
					member_email1=#{member_email1},
				</if>
				<if test=" member_email2!='' and member_email2!=null">
					member_email2=#{member_email2},
				</if>
				<if test=" member_zipcode!='' and member_zipcode!=null">
					member_zipcode=#{member_zipcode},
				</if>
				<if test=" member_roadAddress!='' and member_roadAddress!=null">
					member_roadAddress=#{member_roadAddress},
				</if>
				<if test=" member_jibunAddress!='' and member_jibunAddress!=null">
					member_jibunAddress=#{member_jibunAddress},
				</if>
				<if test=" member_namujiAddress!='' and member_namujiAddress!=null">
					member_namujiAddress=#{member_namujiAddress}
				</if>
			</set> 
			WHERE member_id=#{member_id}
	</update>


	<!-- 회원 삭제 -->
	<delete id="deleteMember" parameterType="String">
		<![CDATA[
			DELETE FROM member 
			WHERE member_id=#{member_id}
    	]]>
	</delete>


	<!-- 마이페이지 비밀번호 체크 -->
	<select id="checkPwd" resultType="int">
		select COUNT(*) from member
		where member_id=#{member_id} AND member_pw=#{member_pw}
	</select>
	
	
	
	<!-- 마이페이지 월세지원 상담글 불러오기 -->
	<select id="selectMonthQnasList" resultMap="qnasResult">
    <![CDATA[
      SELECT qna_no, member_id, qna_title, qna_date, qna_pw, qna_policy, qna_reply
      FROM board_qna
      WHERE member_id=#{member_id} AND qna_policy= '청년월세지원'
    ]]>
	</select>
	
	<!-- 마이페이지 월세지원 상담글 불러오기 -->
	<select id="selectRentQnasList" resultMap="qnasResult">
    <![CDATA[
      SELECT qna_no, member_id, qna_title, qna_date, qna_pw, qna_policy, qna_reply
      FROM board_qna
      WHERE member_id=#{member_id} AND qna_policy= '전월세보증금이자지원'
    ]]>
	</select>
	
	<!-- 마이페이지 월세지원 상담글 불러오기 -->
	<select id="selectReturnQnasList" resultMap="qnasResult">
    <![CDATA[
      SELECT qna_no, member_id, qna_title, qna_date, qna_pw, qna_policy, qna_reply
      FROM board_qna
      WHERE member_id=#{member_id} AND qna_policy= '전세반환보증금보증료지원'
    ]]>
	</select>
	
	<!-- 마이페이지 월세지원 상담글 불러오기 -->
	<select id="selectWeddingQnasList" resultMap="qnasResult">
    <![CDATA[
      SELECT qna_no, member_id, qna_title, qna_date, qna_pw, qna_policy, qna_reply
      FROM board_qna
      WHERE member_id=#{member_id} AND qna_policy= '귀환신혼부부전세이자지원'
    ]]>
	</select>
	
	<!-- 마이페이지 월세지원 상담글 불러오기 -->
	<select id="selectShareQnasList" resultMap="qnasResult">
    <![CDATA[
      SELECT qna_no, member_id, qna_title, qna_date, qna_pw, qna_policy, qna_reply
      FROM board_qna
      WHERE member_id=#{member_id} AND qna_policy= '청년희망주택이자지원'
    ]]>
	</select>
	
	

</mapper>
